[painterdrown Blog](https://painterdrown.github.io) - [painterdrown CV](https://painterdrown.github.io/cv)

# MobileNetV2 å­¦ä¹ ç¬”è®°

> â° 2018-05-28 19:16:22<br/>
> ğŸ‘¨ğŸ»â€ğŸ’» painterdrown

@[toc]

## 0. Abstract

è¿™ç¯‡è®ºæ–‡ä»‹ç»äº†ä¸€ç§æ–°çš„ç§»åŠ¨ç¥ç»ç½‘ç»œæ¶æ„ **MobileNetV2**ï¼Œæå‡äº†å¤šä»»åŠ¡çš„è¡¨ç°ä»¥åŠæ¶µç›–äº†ä¸åŒå¤§å°çš„æ¨¡å‹ã€‚SSDLite ç”¨äºç›®æ ‡æ£€æµ‹ï¼ŒMobileDeepLabv3 ç”¨äºè¯­ä¹‰åˆ†å‰²ã€‚MobileNetV2 æ˜¯åŸºäºæ®‹å·®ç»“æ„ï¼Œå…¶ä¸­é—´æ‹“å±•å±‚ä½¿ç”¨äº†éçº¿æ€§è½»é‡æ·±åº¦å·ç§¯æ¥å¯¹ feature map è¿›è¡Œè¿‡æ»¤ã€‚MobileNetV2 æ”¯æŒå¯¹è¾“å…¥è¾“å‡ºåŸŸåšè§£è—•ã€‚

## 1. Introduction

æ„æ€å¤§æ¦‚æ˜¯ï¼Œç›®å‰æœ€å‰æ²¿çš„ç”¨äºç›®æ ‡æ£€æµ‹çš„ç¥ç»ç½‘ç»œæ¨¡å‹ï¼Œéƒ½éœ€è¦å¤§é‡çš„è®¡ç®—èµ„æºï¼Œå› æ­¤ä¸é€‚ç”¨äºç§»åŠ¨è®¾å¤‡å’ŒåµŒå…¥å¼è®¾å¤‡ã€‚MobileNetV2 åº”è¿è€Œç”Ÿï¼Œæœ‰ä¸‰ä¸ªç‰¹ç‚¹ï¼š

1. æ— éœ€å¤§é‡çš„è®¡ç®—
2. æ— éœ€å¤§é‡çš„å†…å­˜å¼€é”€
3. ä¿æŒç€è‰¯å¥½çš„æ£€æµ‹ç²¾åº¦

ä¸Šé¢è¯´çš„ä¸‰ç‚¹å…¶å®è·Ÿ MobileNets ä¸€æ ·ã€‚è€Œ MobileNetV2 çš„ä¸»è¦åˆ›æ–°ä¹‹å¤„æ˜¯åœ¨ç¥ç»ç½‘ç»œå±‚ï¼šthe inverted residual with linear bottleneckï¼ˆçº¿æ€§ç“¶é¢ˆçš„åå‘æ®‹å·®ç»“æ„ï¼‰ã€‚æˆ‘åœ¨ CSDN æ‰¾åˆ°[ä¸€ç¯‡è®ºæ–‡](https://blog.csdn.net/u011995719/article/details/79135818)æ˜¯è¿™æ ·è§£é‡Šçš„ï¼š

> é€šå¸¸çš„ residuals block æ˜¯å…ˆç»è¿‡ä¸€ä¸ª 1\*1 çš„ conv layerï¼ŒæŠŠ feature map çš„é€šé“æ•°â€œå‹â€ä¸‹æ¥ï¼Œå†ç»è¿‡ 3\*3 conv layerï¼Œæœ€åç»è¿‡ä¸€ä¸ª 1\*1 çš„ conv layerï¼Œå°† feature map é€šé“æ•°å†â€œæ‰©å¼ â€å›å»ã€‚å³å…ˆâ€œå‹ç¼©â€ï¼Œæœ€åâ€œæ‰©å¼ â€å›å»ã€‚è€Œ inverted residualså°±æ˜¯ å…ˆâ€œæ‰©å¼ â€ï¼Œæœ€åâ€œå‹ç¼©â€ã€‚

> linear bottlenecksï¼Œä¸ºäº†é¿å… relu å¯¹ç‰¹å¾çš„ç ´åï¼ˆæˆ‘ä»¬çŸ¥é“ relu å‡½æ•°åªå–è¾“å…¥çš„éè´Ÿå€¼ï¼Œä¸”è®¤ä¸ºè¿™ä¸ªè¡Œä¸ºå¯¼è‡´äº†ä¿¡æ¯æŸå¤±ï¼‰ï¼Œåœ¨ residual block çš„ Eltwise sum ä¹‹å‰çš„é‚£ä¸ª 1\*1 conv ä¸å†é‡‡ç”¨ reluã€‚

è¿™ä¸ªæ–¹æ³•å…ˆæ˜¯æ¥æ”¶ä¸€ä¸ªä½ç»´ã€å‹ç¼©çš„ç‰¹å¾è¡¨ç¤ºï¼Œç„¶åæ‹“å±•å…¶åˆ°é«˜ç»´ï¼Œåœ¨ç”¨ä¸€ä¸ªè½»é‡æ·±åº¦å·ç§¯è¿›è¡Œè¿‡æ»¤ã€‚è¿‡æ»¤åå¾—åˆ°çš„ç‰¹å¾ä¼šè¢«ä¸€ä¸ªçº¿æ€§å·ç§¯æ˜ å°„å›ä½ç»´çš„è¡¨ç¤ºã€‚

## 2. Preliminariesï¼ˆå‡†å¤‡å·¥ä½œï¼‰, Discussion and Intuitionï¼ˆç›´è§‰ï¼‰

### 2.1. Depthwise Separable Convolutions

> å‚è€ƒï¼š[MobileNets å­¦ä¹ ç¬”è®°](https://painterdrown.github.io/cv/mobilenet) ä¸­çš„ Depthwise Separable Convolution

è¿™é‡Œçš„æ·±åº¦å¯åˆ†ç¦»å·ç§¯è·Ÿ MobileNets çš„å”¯ä¸€åŒºåˆ«åœ¨äºï¼šMobileNets çš„è¾“å…¥è¾“å‡ºéƒ½æ˜¯æ­£æ–¹å½¢çš„ featureï¼Œè€Œ MobileNetV2 åˆ™å…è®¸é•¿å®½ä¸ä¸€æ ·ã€‚

### 2.2. Linear Bottlenecksï¼ˆçº¿æ€§ç“¶é¢ˆï¼‰

![](images/bottleneck1.png)

![](images/bottleneck2.png)

è¿™ä¸€æ®µä¸å¤ªå¥½ç†è§£ï¼Œæˆ‘æ„Ÿè§‰å°±æ˜¯ ReLU ä¼šæŸå¤±è´Ÿæ•°çš„é‚£éƒ¨åˆ†ä¿¡æ¯ï¼Œå› æ­¤è¦æƒ³åŠæ³•æ¢æˆä¸ä¼šæŸå¤±ä¿¡æ¯çš„çº¿æ€§æ¿€æ´»å‡½æ•°ã€‚ä½œè€…æåˆ°ä¸¤ç‚¹ï¼š

1. å¦‚æœç»è¿‡ ReLU ä¹‹åï¼Œ**manifold of interest**ï¼ˆformed by a set of layer activationsï¼‰ è¿˜æ˜¯éé›¶çš„è¯ï¼Œå…¶ç›¸å½“äºåšäº†ä¸€ä¸ªçº¿æ€§è½¬æ¢è€Œå·²ã€‚
2. å¦‚æœ manifold of interest æ˜¯å¤„äºä½ç»´å­ç©ºé—´ä¸­ï¼Œç»è¿‡ ReLU æ—¶å°±ä¸ä¼šæŸå¤±ä¿¡æ¯ã€‚

å› æ­¤ï¼Œå¦‚æœ manifold of interest æ˜¯ä½ç»´çš„è¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡å¾€å·ç§¯å—æ’å…¥ linear bottleneck å±‚æ•è·ä¹‹ã€‚

### 2.3. Inverted residualsï¼ˆåå‘æ®‹å·®ï¼‰

![](images/residual.png)

è¿™ä¸€æ®µæ›´æ˜¯çœ‹å¾—æˆ‘äº‘é‡Œé›¾é‡Œçš„ï¼Œé‚æœæ–­æŸ¥åšå®¢ã€‚

> [ã€ç™¾åº¦ç»éªŒã€‘MobileNetV2: åå‘æ®‹å·®å’Œçº¿æ€§ç“¶é¢ˆ](http://baijiahao.baidu.com/s?id=1597561152826234409)

æ®‹ä½™å—å°†å·ç§¯å—çš„å¼€å§‹å’Œç»“å°¾è¿æ¥åˆ°è·³è¿‡è¿æ¥ã€‚é€šè¿‡æ·»åŠ è¿™ä¸¤ä¸ªçŠ¶æ€ï¼Œç½‘ç»œæœ‰æœºä¼šè®¿é—®åœ¨å·ç§¯å—ä¸­æœªä¿®æ”¹çš„æ—©æœŸæ¿€æ´»ã€‚è¿™ç§æ–¹æ³•å¯¹äºå»ºç«‹æ·±åº¦ç½‘ç»œéå¸¸é‡è¦ã€‚æ®‹ä½™å—å°†å®½å±‚ä¸è·³è·ƒè¿æ¥ç›¸è¿ï¼Œè€Œå±‚ä¹‹é—´çš„å±‚è¾ƒçª„ã€‚

å½“æˆ‘ä»¬ç¨å¾®é è¿‘è·³è¿‡è¿æ¥æ—¶ï¼Œæˆ‘ä»¬ä¼šæ³¨æ„åˆ°, åŸå§‹çš„æ®‹ä½™å—ä¼šè·Ÿéšä¸€ä¸ªå®½ >> çª„ >> å®½çš„æ–¹æ³•æ¥å¤„ç†é€šé“çš„æ•°é‡ã€‚è¾“å…¥ä¿¡é“æ•°é‡å¾ˆå¤šï¼Œå¹¶ç”¨å»‰ä»·çš„ 1\*1 å·ç§¯è¿›è¡Œå‹ç¼©ã€‚è¿™æ ·ä¸‹é¢çš„ 3\*3 å·ç§¯çš„å‚æ•°å°±å°‘å¾—å¤šäº†ã€‚ä¸ºäº†æœ€ç»ˆå¢åŠ è¾“å…¥å’Œè¾“å‡ºï¼Œä½¿ç”¨å¦ä¸€ä¸ª 1\*1 å·ç§¯å†æ¬¡å¢åŠ é€šé“çš„æ•°é‡ã€‚

> [ã€çŸ¥ä¹ã€‘å¦‚ä½•è¯„ä»·mobilenet v2 ?](https://www.zhihu.com/question/265709710/answer/297996096)

## 3. Model Architecture

1. å…¨å·ç§¯å±‚ï¼Œæœ‰ 32 ä¸ªè¿‡æ»¤å™¨
2. 19 residual bottleneck layers
3. éçº¿æ€§æ¿€æ´»å‡½æ•° ReLU6
4. kernel size 3 Ã— 3
5. è®­ç»ƒæ—¶ç”¨ dropout & batch normalization æ¥é˜²æ­¢è¿‡æ‹Ÿåˆ
6. é™¤äº†ç¬¬ä¸€å±‚ï¼Œå‰©ä¸‹çš„ç½‘ç»œéƒ½ç”¨äº† constant expansion rateï¼ˆå°ç½‘ç»œè¦ç”¨å° ERï¼Œå¤§ç½‘ç»œè¦ç”¨å¤§ ERï¼‰

## 4. Resources

+ [MobileNetV2: Inverted Residuals and Linear Bottlenecks](../papers/MobileNetV2.pdf)
+ [chuanqi305/MobileNetv2-SSDLiteï¼ˆéå®˜æ–¹ï¼‰](https://github.com/chuanqi305/MobileNetv2-SSDLite)
