[painterdrown Blog](https://painterdrown.github.io) - [painterdrown CV](https://painterdrown.github.io/cv)

# Deep Feature Flow for Video Recognition å­¦ä¹ ç¬”è®°

> â° 2018-06-01 00:00:00<br/>
> ğŸ‘¨ğŸ»â€ğŸ’» painterdrown

[TOC]

Oh yeah, ç»ˆäºå¼€å§‹çœ‹è§†é¢‘ç›®æ ‡æ£€æµ‹å•¦ï¼BTWï¼ŒğŸˆ *Happy Children's Day* ğŸˆ

## 0. Abstract

ç›®å‰çš„å›¾åƒç›®æ ‡æ£€æµ‹å·²ç»å‘å±•åœ°æ¯”è¾ƒæˆç†Ÿäº†ï¼Œä¸è¿‡å¦‚æœå•å¸§åœ°åº”ç”¨åœ¨è§†é¢‘ä¸Šåˆ™æ˜¾å¾—å¤ªæ…¢äº†ã€‚ä½œè€…æå‡ºäº† deep feature flowï¼ˆæ·±åº¦ç‰¹å¾æµï¼Œä¸€ä¸ªåˆå¿«åˆå‡†çš„è§†é¢‘ç›®æ ‡æ£€æµ‹æ¡†æ¶ã€‚å®ƒåªåœ¨ sparse key frames ä¸Šè·‘å·ç§¯ï¼Œé€šè¿‡ deep feature maps åœ¨åŒä¸€ä¸ªæµåœºï¼ˆæˆ‘ç†è§£ä¸ºä¸€æ®µè¿ç»­çš„ä¸”æ¯”è¾ƒç›¸ä¼¼çš„å¸§ï¼‰çš„å…¶å®ƒå¸§ä¹‹é—´è¿›è¡Œä¼ æ’­ã€‚è®­ç»ƒæ˜¯ç«¯åˆ°ç«¯çš„ï¼Œé€Ÿåº¦å’Œç²¾åº¦ï¼ˆç²¾åº¦æœ‰å—ï¼Ÿæ„Ÿè§‰è¿˜ä¸å¦‚ Faster R-CNNï¼‰ä¸Šéƒ½æœ‰æ˜æ˜¾çš„æå‡ã€‚

## 1. Introduction

ä»å›¾åƒè¯†åˆ«åˆ°è§†é¢‘è¯†åˆ«ï¼Œè¦å¤„ç†å¥½è§†é¢‘å¸§ä¹‹é—´çš„è¿ç»­æ€§ä»¥åŠå†—ä½™çš„ä¿¡æ¯ã€‚ç°åœ¨å¤§å¤šæ•°çš„ CNN æ¶æ„é‡Œé¢ï¼Œå·ç§¯è®¡ç®—å è®¡ç®—èµ„æºæ¶ˆè€—çš„ä¸»ä½“ã€‚è®¡ç®—å‡ºæ¥çš„ convolutional feature maps ä¿ç•™äº†å›¾åƒçš„ä½çº§å†…å®¹åˆ°ä¸­é«˜çº§è¯­ä¹‰å†…å®¹çš„å¯¹åº”å…³ç³»ã€‚è¿™æ ·ä¸€æ¥ï¼Œå°±å¯ä»¥è½»æ˜“åœ°åœ¨ç›¸é‚»å¸§ä¹‹é—´ä¼ æ’­ç‰¹å¾ä¿¡æ¯ï¼ˆby spatial warping ç©ºé—´å˜å½¢ï¼‰ï¼Œè¿™ä¸å…‰æµç±»ä¼¼ã€‚

ä¸€èˆ¬æ¥è¯´ï¼Œflow estimation & feature propagation æ¯”ç®€å•åœ°å»è®¡ç®—å¤šå¸§çš„ convolutional features è¦å¿«å¾—å¤šã€‚è€Œä¸”å¦‚æœèƒ½ç”¨ç½‘ç»œåš flow estimation çš„è¯ï¼Œæ•´ä¸ªè§†é¢‘ç›®æ ‡æ£€æµ‹æ¶æ„å°±æ˜¯ç«¯åˆ°ç«¯çš„ã€‚

![](images/motivation.png)

## 2. Related Work

+ **Image Recognition**ã€‚å·²ç»æœ‰å¾ˆå¤šæˆç†Ÿçš„ç½‘ç»œäº†ï¼Œå¯ä»¥çœ‹æˆ‘å‰é¢å›¾åƒç›®æ ‡è¯†åˆ«çš„å­¦ä¹ ç¬”è®°ï¼Œè¿™é‡Œä¸èµ˜è¿°ã€‚

+ **Network Acceleration**ã€‚æ¯”å¦‚ Fast R-CNN é‡Œé¢çš„çŸ©é˜µåˆ†è§£ï¼›æ¯”å¦‚ [Quantized Neural Networks](../papers/Quantized_Neural_Networks.pdf) çš„å‚æ•°é‡å­åŒ–ï¼ˆæš‚æœªäº†è§£ï¼‰ã€‚

+ **Optical Flowï¼ˆå…‰æµï¼‰**ã€‚è¿™ä¸ªæˆ‘ä¹‹å‰åœ¨ç ”ç©¶ç”Ÿå­¦ä¹ ç­é‡Œå‡ æ¬¡å¬åˆ°è¿™ä¸ªæ¦‚å¿µã€‚å®ƒæ˜¯è§†é¢‘åˆ†æçš„åŸºæœ¬ä»»åŠ¡ï¼Œç›®å‰ä¸»è¦å…³æ³¨çš„æ˜¯ small displacementsï¼Œæœ€è¿‘é€æ¸è½¬å‘ large displacementsï¼Œä»¥åŠåŠ å…¥ combinatorial matchingï¼ˆç»„åˆåŒ¹é…ï¼‰è¿™ä¸ªæ¦‚å¿µã€‚ç°åœ¨çš„æ·±åº¦å­¦ä¹ å·²ç»é€æ¸æ¼«å»¶åˆ°å…‰æµè¿™ä¸€å—ï¼Œ[FlowNet](../papers/FlowNet.pdf) ç”¨æ·±å±‚ CNN æ¥ä¼°ç®—è§†é¢‘ä¸­çš„ motion å¹¶ä¸”æœ‰ä¸é”™çš„æ•ˆæœã€‚æ€»è€Œè¨€ä¹‹ï¼Œå…‰æµåœ¨è®¡ç®—æœºè§†è§‰æ–¹é¢æœ‰å¥‡æ•ˆï¼Œæ¯”å¦‚ pose estimationï¼ˆå§¿æ€ä¼°è®¡ï¼‰ï¼Œåº”è¯¥æ¢ç´¢å¦‚ä½•åº”ç”¨äºè§†é¢‘ç›®æ ‡æ£€æµ‹ä¸­ã€‚

+ **Exploiting Temporal Information in Video Recognition**ã€‚è¿™é‡Œè¦è§£å†³çš„é—®é¢˜æ˜¯ï¼Œå¦‚ä½•æŒ–æ˜è§†é¢‘ä¸­çš„æ—¶é—´ä¿¡æ¯ï¼Ÿåœ¨ [T-CNN](../papers/T-CNN.pdf) é‡Œé¢ï¼Œå…¶èåˆäº†æ—¶é—´å’Œä¸Šä¸‹æ–‡ä¿¡æ¯ï¼›[FSO](../papers/FSO.pdf) æå‡ºäº†å¤§èŒƒå›´çš„æ—¶ç©ºæ­£åˆ™åŒ–ï¼›[STFCN](../papers/STFCN.pdf) ç”¨ä¸€ä¸ªæ—¶ç©ºçš„ FCN æ¥åšè§†é¢‘è¯­ä¹‰åˆ†å‰²ã€‚è™½ç„¶è¿™äº›æ–¹æ³•æå‡äº†ç²¾åº¦ï¼Œä½†æ˜¯è¿˜æ˜¯éœ€è¦å¤§é‡çš„è®¡ç®—ï¼Œå½±å“äº†é€Ÿåº¦ã€‚

+ **Slow Feature Analysis**ã€‚åœ¨è§†é¢‘é‡Œé¢ï¼Œé«˜çº§çš„è¯­ä¹‰æ¦‚å¿µå¾€å¾€æ¯”ä½çº§çš„å›¾åƒå¤–è§‚æ¼”åŒ–å¾—æ›´æ…¢ï¼Œå› æ­¤è¿™äº›æ·±åº¦çš„ç‰¹å¾åœ¨è§†é¢‘å¸§ä¹‹é—´çš„å˜åŒ–ååˆ†å¹³æ»‘ã€‚

+ **[Clockwork Convnets](../papers/Clockwork_Convnets.pdf)**ã€‚å®ƒåšçš„äº‹æƒ…è·Ÿ Deep Feature Flow å¾ˆç±»ä¼¼ï¼šéƒ½æ˜¯ä½¿ç½‘ç»œä¸­çš„æŸäº›å±‚åœ¨è§†é¢‘ä¸­çš„æŸäº›å¸§ä¸Šå¤±æ•ˆä»¥åŠç‰¹å¾å¤ç”¨ã€‚ä½†æ˜¯ç”±äºæ²¡æœ‰è€ƒè™‘åˆ°ä¸åŒå¸§ä¹‹é—´çš„å¯¹åº”ä¿¡æ¯ï¼ŒClockwork Convnets åœ¨åŠ é€Ÿçš„æ—¶å€™ä¼šæŸå¤±è¾ƒå¤šçš„ç²¾åº¦ã€‚

## 3. Deep Feature Flow

![](images/architecture.png)

### 3.1. Inference

æ€»ç½‘ç»œï¼ˆfeed-forward convolutional neutralï¼‰å¯ä»¥åˆ†è§£ä¸ºè¿ç»­çš„ä¸¤éƒ¨åˆ†ï¼š**N~feat~ï¼ˆç‰¹å¾ç½‘ç»œï¼‰** å’Œ **N~task~ï¼ˆä»»åŠ¡ç½‘ç»œï¼‰**ã€‚å‰è€…ï¼ˆå…¨å·ç§¯ï¼‰ä¼šè¾“å‡ºè®¸å¤š feature mapsï¼Œåè€…ä¼šåœ¨è¿™äº› feature maps ä¸Šé¢åšæ£€æµ‹ä»»åŠ¡ã€‚

é€šè¿‡æµä¼°è®¡ç®—æ³•å¾—åˆ° flow fieldï¼ˆæˆ‘ç†è§£ä¸ºå…³é”®å¸§åŠå…¶ç›¸é‚»å¸§ä¹‹é—´çš„æµä¿¡æ¯ï¼‰ã€‚é€šè¿‡åŒçº¿æ€§æ’å€¼æ¥åš feature warpingã€‚ä¸ºäº†å‡å°‘æµä¼°è®¡ç®—æ³•å¸¦æ¥çš„è¯¯å·®ï¼Œé€šè¿‡ â€œscale fieldâ€ æ¥åšæ›´å¥½çš„ç‰¹å¾ä¼°è®¡ã€‚

ä¼ªä»£ç å¦‚ä¸‹ï¼š

![](images/code.png)

### 3.2. Training

Flow function æœ¬æ¥æ˜¯ç”¨æ¥è·å–ä½çº§çš„å›¾åƒä¿¡æ¯çš„ï¼Œä¸é€‚ç”¨äºé«˜çº§ feature maps çš„æå–ã€‚ä½œè€…ç”¨ä¸€ä¸ª CNN å»ä¼°ç®— flow fiel å’Œ scale fieldã€‚å› æ­¤ï¼Œå°±å¯ä»¥è¿›è¡Œç«¯åˆ°ç«¯çš„è®­ç»ƒã€‚

è®­ç»ƒçš„æ–¹æ³•æ˜¯ **SGDï¼ˆéšæœºæ¢¯åº¦ä¸‹é™ï¼‰**ã€‚åœ¨æ¯ä¸€ä¸ª mini-batch é‡Œé¢ï¼Œéšæœºåœ°åˆ°è¿ç»­çš„ 10 å¸§é‡Œé¢éšæœºæŠ½å–ä¸¤å¸§ I~k~ï¼ˆå…³é”®å¸§ï¼‰ å’Œ I~i~ã€‚å‰é¢è¯´åˆ°çš„ **N~feat~** è·‘åœ¨ I~k~ ä¸Šï¼Œç„¶å **flow network N~flow~** è·‘åœ¨ I~k~ å’Œ I~i~ ä¸Šæ¥ç®—å‡º flow field å’Œ scale fieldã€‚N~flow~ çš„é€Ÿåº¦è¦æ¯” N~feat~ å¿«å¾ˆå¤šï¼Œå‰è€…æ˜¯åœ¨ *Flying Chairs dataset* ä¸Šé¢„è®­ç»ƒçš„ã€‚åœ¨ N~flow~ æœ€åè¾“å‡ºå±‚åŠ ä¸Šä¸€ä¸ª siblingï¼šscale functionã€‚

å€¼å¾—ä¸€æçš„æ˜¯ï¼Œè§†é¢‘æ£€æµ‹çš„è®­ç»ƒé›†æ ‡æ³¨çš„ä»£ä»·å¾ˆé«˜ï¼ˆç‰¹åˆ«æ˜¯å¯¹äºé‡‡ç”¨ per-frame åšæ³•çš„ç½‘ç»œï¼‰ã€‚ä½†æ˜¯ DFF åˆ™ä¸åŒï¼Œå®ƒåªè¦æ±‚ I~i~ å¸§çš„æ•°æ®é›†æœ‰æ ‡å‡†å°±è¶³å¤Ÿäº†ã€‚

### 3.3. Inference Complexity Analysis

è¿™ä¸€æ®µä¸»è¦æ˜¯åœ¨åˆ†æ inference çš„å¤æ‚åº¦ï¼Œinference å¯ä»¥ç†è§£ä¸ºç”¨è®­ç»ƒå‡ºæ¥çš„æ¨¡å‹å» testã€‚åˆ†æçš„è¿‡ç¨‹å‚è€ƒåŸè®ºæ–‡å§ã€‚

### 3.4. Key Frame Scheduling

è¿™ç¯‡è®ºæ–‡ç”¨çš„æ–¹æ³•æ˜¯å›ºå®šé•¿åº¦åœ°é€‰å–ä¸€ä¸ªå…³é”®å¸§ã€‚ä½†æ˜¯ä½œè€…æåˆ°ï¼Œæœ€ç†æƒ³çš„åšæ³•æ˜¯å°†å‘ç”Ÿå‰§çƒˆå˜åŒ–çš„å¸§ä½œä¸ºå…³é”®å¸§ã€‚

## 4. Network Architectures

### 4.1. Flow Network

è¿™é‡Œç”¨çš„æ˜¯ [FlowNet](../papers/FlowNet.pdf) çš„ç®€å•ç‰ˆæœ¬ï¼šå°†æ¯ä¸€å±‚å·ç§¯æ ¸çš„æ•°ç›®å‡å°‘ä¸€åŠï¼Œè¿™æ ·æ•´ä¸ªç½‘ç»œçš„å¤æ‚åº¦å°±å˜ä¸ºåŸæ¥çš„å››åˆ†ä¹‹ä¸€ã€‚å†è€…ï¼ŒåŠ å…¥ *FlowNet Inception* å¹¶ä¸”å°†å…¶å¤æ‚åº¦é™ä½ä¸º FlowNet çš„å…«åˆ†ä¹‹ä¸€ã€‚

### 4.2. Feature Network

è¿™é‡Œç”¨çš„æ˜¯åœ¨ ImageNet ä¸Šé¢„è®­ç»ƒçš„ **ResNet-50** å’Œ **ResNet-101**ï¼ˆå–æ¶ˆäº†æœ€åçš„ 1000-way åˆ†ç±»å±‚ï¼‰ã€‚ä¸ºäº†ç”Ÿæˆæ›´ç¨ å¯†çš„ feature mapsï¼Œå°†å…¶æ­¥é•¿ä» 32 å‡å°åˆ° 16ã€‚åé¢ï¼š

+ å¦‚æœåšè¯­ä¹‰åˆ‡å‰²ï¼Œåˆ™ç”¨ **DeepLab**ï¼›
+ å¦‚æœåšç›®æ ‡æ£€æµ‹ï¼Œåˆ™ç”¨ **R-FCN**ã€‚

### 4.3. Semantic Segmentation

æš‚æ—¶å¯¹è¿™é‡Œæ²¡å…´è¶£ã€‚

### 4.4. Object Detection

> å‚è€ƒ [R-FCN å­¦ä¹ ç¬”è®°](https://painterdrown.github.io/cv/rfcn)ï¼Œè¿™é‡Œä¸åšèµ˜è¿°ã€‚

## 5. Future Work

ç”±äºè¦ç ”ç©¶è§†é¢‘ç›®æ ‡æ£€æµ‹è¿™ä¸€å—ï¼Œæ‰€ä»¥æœ‰å¿…è¦äº†è§£ä¸€ä¸‹è¿™ä¸ªè¯é¢˜ã€‚

> 1. How the joint learning affects the flow quality?

ä½œè€…ç›®å‰æ— æ³•å¯¹æ­¤è¿›è¡Œä¼°ç®—ï¼Œå› ä¸ºç¼ºå°‘ ground truthï¼ˆçœŸå®æ•°æ®ï¼‰ã€‚ç›®å‰ä¼ ç»Ÿçš„å…‰æµæŠ€æœ¯å—é™äºäººé€ çš„æˆ–è€…å°çš„æ•°æ®é›†ï¼Œå¯¹äºæ·±åº¦å­¦ä¹ æ¥è¯´æ•°æ®è¿˜æ˜¯å¾ˆç¨€ç¼ºçš„ã€‚

> 2. How to benefit from improvements in flow estimation and key frame scheduling?

å…³é”®å¸§çš„é€‰æ‹©ä¼šè¾ƒå¤§åœ°å½±å“åé¢çš„æ£€æµ‹æ•ˆæœã€‚ä½œè€…å‰é¢æåˆ°ï¼Œè¿™ç¯‡è®ºæ–‡æ˜¯å®šé•¿åœ°é€‰å–å…³é”®å¸§ã€‚ç„¶è€Œæœ€ä½³çš„åšæ³•æ˜¯é€‰å–å˜åŒ–æœ€å¤§çš„å¸§ä½œä¸ºå…³é”®å¸§ï¼Œç›®å‰æ¥è¯´è¿™å¯èƒ½ä¼šæ¶ˆè€—è¿‡å¤šçš„è®¡ç®—èµ„æºï¼Œå¸Œæœ›åœ¨å°†æ¥èƒ½åœ¨å°†è¿™ä¸ª task æ”¾åœ¨ç½‘ç»œä¸­æ¥åšã€‚

## 6. Resources

+ [Deep Feature Flow for Video Recognition](../papers/DFF.pdf)
+ [GitHub (python)](https://github.com/msracver/Deep-Feature-Flow)
